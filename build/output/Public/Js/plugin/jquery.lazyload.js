function imageResizeWithTwoLimit(t,i,e,o){var n={};return n.width=t,n.height=i,t>e&&(n.width=e,n.height=e*i/t),n.height>o&&(n.width=o*t/i,n.height=o),n}function imageResize(t,i,e){var o={};return t>e?(o.width=e,o.height=e*i/t):(o.width=t,o.height=i),o}!function(t){t.fn.lazyload=function(i){var e={threshold:400,failurelimit:50,event:"scroll",effect:"show",container:window,dimension:{width:209,height:209},heightlimit:!1};i&&t.extend(e,i);var o=e.dimension,n=e.heightlimit,r=this;return"scroll"==e.event&&t(e.container).bind("scroll",function(){var i=0;r.each(function(){if(t.abovethetop(this,e)||t.leftofbegin(this,e));else if(t.belowthefold(this,e)||t.rightoffold(this,e)){if(i++>e.failurelimit)return!1}else t(this).trigger("appear")});var o=t.grep(r,function(t){return!t.loaded});r=t(o)}),this.each(function(){var i=this,r=t(i).parent().siblings(".picture_loading"),h=t(".picture_reload",t(i).parent().parent());if(h.size()<1){var a=[];a.push('<p class="picture_reload">'),a.push('<a href="#"'),a.push(">重新加载</a></p>");var d=a.join("");h=t(d),h.css({width:o.width}),o.width<90&&h.addClass("picture_reload_min"),t(i).parent().parent().append(h)}h.click(function(){var i=t(this).siblings("a").find("img");return r.fadeIn(),i[0].src=i[0].getAttribute("original"),resetImage(i,o),!1}),t(i).one("appear",function(){this.loaded||t("<img />").bind({load:function(){if(t(i).attr("original")){if(t(i).css("opacity",0).attr("src",t(i).attr("original")).animate({opacity:1},100,function(){h.hide(),r.fadeOut("fast")}),1==this.width&&1==this.height&&(t(i).attr("src","../images/default2.png"),this.width=310,this.height=310),n)var e=imageResizeWithTwoLimit(this.width,this.height,o.width,o.height);else var e=imageResize(this.width,this.height,o.width,o.height);t(i).css({width:e.width,height:e.height}),i.loaded=!0}},error:function(){t(i).attr("src","../images/default2.png").css({width:e.dimension.width}),r.fadeOut("fast"),i.errored=!0}}).attr("src",t(i).attr("original"))}),"scroll"!=e.event&&t(i).bind(e.event,function(){i.loaded||t(i).trigger("appear")})}),this},t.belowthefold=function(i,e){if(void 0===e.container||e.container===window)var o=t(window).height()+t(window).scrollTop();else var o=t(e.container).offset().top+t(e.container).height();return o<=t(i).offset().top-e.threshold},t.rightoffold=function(i,e){if(void 0===e.container||e.container===window)var o=t(window).width()+t(window).scrollLeft();else var o=t(e.container).offset().left+t(e.container).width();return o<=t(i).offset().left-e.threshold},t.abovethetop=function(i,e){if(void 0===e.container||e.container===window)var o=t(window).scrollTop();else var o=t(e.container).offset().top;return o>=t(i).offset().top+e.threshold+t(i).height()},t.leftofbegin=function(i,e){if(void 0===e.container||e.container===window)var o=t(window).scrollLeft();else var o=t(e.container).offset().left;return o>=t(i).offset().left+e.threshold+t(i).width()},t.extend(t.expr[":"],{"below-the-fold":"$.belowthefold(a, {threshold : 0, container: window})","above-the-fold":"!$.belowthefold(a, {threshold : 0, container: window})","right-of-fold":"$.rightoffold(a, {threshold : 0, container: window})","left-of-fold":"!$.rightoffold(a, {threshold : 0, container: window})"})}(jQuery);